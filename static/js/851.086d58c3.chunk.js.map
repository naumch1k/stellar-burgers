{"version":3,"file":"static/js/851.086d58c3.chunk.js","mappings":"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","sources":["webpack://stellar-burgers/./src/components/ErrorMessage/ErrorMessage.module.css?d773","components/ErrorMessage/ErrorMessage.tsx","hooks/useIngredientCount.ts","webpack://stellar-burgers/./src/components/OrderDetailsIngredient/OrderDetailsIngredient.module.css?27b6","components/OrderDetailsIngredient/OrderDetailsIngredient.tsx","webpack://stellar-burgers/./src/components/OrderDetails/OrderDetails.module.css?8291","components/OrderDetails/OrderDetails.tsx","webpack://stellar-burgers/./src/pages/Order/Order.module.css?2b8b","pages/Order/Order.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"root\":\"ErrorMessage_root__kSKWw\"};","import { ReactNode } from 'react'\nimport styles from './ErrorMessage.module.css'\n\ninterface IErrorMessageProps {\n  children: ReactNode;\n}\n\nexport const ErrorMessage = ({ children }: IErrorMessageProps) => (\n  <p className={`${styles.root} text text_type_main-large`}>\n    {children}\n  </p>\n)\n","import { IIngredient } from 'shared/types'\n\nfunction useIngredientCount({\n  ingredients,\n  ingredientId,\n}: {\n  ingredients:(IIngredient | undefined)[];\n  ingredientId: string;\n}) {\n  const ingredientCount = ingredients.reduce((count, ingredient) => {\n    if (ingredient?._id === ingredientId) return count + 1\n    return count\n  }, 0)\n\n  return { ingredientCount }\n}\n\nexport default useIngredientCount\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"OrderDetailsIngredient_root__lxFQA\",\"name\":\"OrderDetailsIngredient_name__pRj2p\",\"price\":\"OrderDetailsIngredient_price__9OTmk\"};","import { useParams } from 'react-router'\nimport { useSelector } from 'react-redux'\nimport { CurrencyIcon } from '@ya.praktikum/react-developer-burger-ui-components'\nimport { IngredientThumbnail } from 'components/ui/IngredientThumbnail'\nimport { IRootState } from 'store/store'\nimport { selectIngredientById } from 'store/ingredients/ingredients.selectors'\nimport useOrderDetails from 'hooks/useOrderDetails'\nimport useIngredientCount from 'hooks/useIngredientCount'\nimport styles from './OrderDetailsIngredient.module.css'\n\ninterface IOrderDetailsIngredientProps {\n  id: string;\n}\n\nexport const OrderDetailsIngredient = ({ id }: IOrderDetailsIngredientProps) => {\n  const ingredient = useSelector((state: IRootState) => selectIngredientById(state, id))\n  const { id: orderId } = useParams()\n  const { ingredients } = useOrderDetails(orderId!)\n  const { ingredientCount } = useIngredientCount({\n    ingredients,\n    ingredientId: id,\n  })\n\n  return (\n    <li className={styles.root}>\n      <IngredientThumbnail id={ingredient!._id}/>\n      <p className={`${styles.name} text text_type_main-default ml-4`}>\n        {ingredient!.name}\n      </p>\n      <p className={`${styles.price} text text_type_digits-default`}>\n        {ingredientCount} x {ingredient!.price}\n        {' '}\n        <CurrencyIcon type='primary' />\n      </p>\n    </li>\n  )\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"OrderDetails_container__iJZOV\",\"number\":\"OrderDetails_number__iw1AR\",\"name\":\"OrderDetails_name__+603E\",\"status\":\"OrderDetails_status__3vn0u\",\"list\":\"OrderDetails_list__wT20n\",\"price\":\"OrderDetails_price__+DUOs\",\"footer\":\"OrderDetails_footer__2HJcW\"};","import { useParams } from 'react-router'\nimport { CurrencyIcon } from '@ya.praktikum/react-developer-burger-ui-components'\nimport { OrderDetailsIngredient } from 'components/OrderDetailsIngredient'\nimport { FormattedDate } from 'components/ui/FormattedDate'\nimport useOrderDetails from 'hooks/useOrderDetails'\nimport styles from './OrderDetails.module.css'\n\nexport const OrderDetails = () => {\n  const { id } = useParams()\n\n  const {\n    number,\n    createdAt,\n    name,\n    status,\n    price,\n    uniqueIngredients,\n  } = useOrderDetails(id!)\n\n  return (\n    <div className={styles.container}>\n      <p className={`${styles.number} text text_type_digits-default`}>#{number}</p>\n      <h3 className={`${styles.name} text text_type_main-medium mt-10`}>{name}</h3>\n      <p className={`\n        ${styles.status}\n        ${status === 'done' ? 'text_color_success' : ''}\n        text text_type_main-default mt-3\n      `}>\n        {status}\n      </p>\n      <ul className={`${styles.list} custom-scroll`}>\n        {uniqueIngredients.map(ingredient => {\n          return (\n            <OrderDetailsIngredient id={ingredient._id} key={ingredient._id}/>\n          )\n        })}\n      </ul>\n      <footer className={`${styles.footer} mt-10`}>\n          <FormattedDate\n            date={createdAt}\n            className='text text_type_main-default text_color_inactive'\n          />\n          <p className={`${styles.price} text text_type_digits-default`}>\n            {price}\n            {' '}\n            <CurrencyIcon type='primary' />\n          </p>\n      </footer>\n    </div>\n  )\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"Order_root__JOTg7\"};","import { useParams } from 'react-router'\nimport { useEffect } from 'react'\nimport { useSelector } from 'react-redux'\nimport { OrderDetails } from 'components/OrderDetails'\nimport { ErrorMessage } from 'components/ErrorMessage'\nimport { Loader } from 'components/Loader'\nimport { IRootState, useAppDispatch } from 'store/store'\nimport {\n  selectWebSocketState,\n  connect,\n  disconnect,\n} from 'store/webSocket/webSocket.slice'\nimport { selectOrderById } from 'store/orders/orders.selectors'\nimport { WS_BASE_URL, ACCESS_TOKEN_KEY } from 'shared/constants'\nimport styles from './Order.module.css'\n\nconst Order = () => {\n  const { id } = useParams()\n  const dispatch = useAppDispatch()\n  const { isConnecting, isFetching } = useSelector(selectWebSocketState)\n  const order = useSelector((state: IRootState) => selectOrderById(state, id!))\n  // TODO: refactor to helper func\n  const accessToken = localStorage.getItem(ACCESS_TOKEN_KEY)?.split('Bearer ')[1]\n\n  useEffect(() => {\n    dispatch(connect(`${WS_BASE_URL}?token=${accessToken}`))\n\n    return () => {\n      dispatch(disconnect())\n    }\n  }, [dispatch, accessToken])\n\n  if (isConnecting || isFetching) return <Loader/>\n\n  return (\n    <div className={styles.root}>\n      {order ? (\n        <OrderDetails/>\n      ) : (\n        <ErrorMessage>\n          <span>Looks like this order launched into deep space ðŸš€</span>\n          <span>No trace found...</span>\n        </ErrorMessage>\n      )}\n    </div>\n  )\n}\n\nexport default Order\n"],"names":["ErrorMessage","_ref","children","_jsx","className","concat","styles","ingredients","ingredientId","ingredientCount","reduce","count","ingredient","_id","OrderDetailsIngredient","id","useSelector","state","selectIngredientById","orderId","useParams","useOrderDetails","useIngredientCount","_jsxs","IngredientThumbnail","name","price","CurrencyIcon","type","OrderDetails","number","createdAt","status","uniqueIngredients","map","FormattedDate","date","Order","_localStorage$getItem","dispatch","useAppDispatch","isConnecting","isFetching","selectWebSocketState","order","selectOrderById","accessToken","localStorage","getItem","ACCESS_TOKEN_KEY","split","useEffect","connect","WS_BASE_URL","disconnect","Loader"],"sourceRoot":""}