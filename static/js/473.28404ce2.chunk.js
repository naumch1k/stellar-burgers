"use strict";(self.webpackChunkstellar_burgers=self.webpackChunkstellar_burgers||[]).push([[473],{2263:(e,t,r)=>{r.d(t,{B:()=>a});const s="ErrorMessage_root__kSKWw";var n=r(184);const a=e=>{let{children:t}=e;return(0,n.jsx)("p",{className:"".concat(s," text text_type_main-large"),children:t})}},7337:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Ne});var s=r(5287),n=r(6401),a=r(335),c=r(2791),l=r(9434),i=r(7963),o=r(1067),d=r(6814),m=r(1987),u=r(7021),p=r(6916);const x=(0,p.P1)((e=>e.burgerConstructor.fillings),(e=>Object.values(e))),_=e=>e.burgerConstructor.bun,g=(0,p.P1)([e=>[e.burgerConstructor.bun,...e.burgerConstructor.fillings],(e,t)=>t],((e,t)=>e.reduce(((e,r)=>(null===r||void 0===r?void 0:r._id)===t?e+("bun"===r.type?2:1):e),0)));var j=r(4236);const h="Ingredient_root__Zh74E",b="Ingredient_beingDragged__pJKPQ",v="Ingredient_name__bUorL",y="Ingredient_price__CIEQs";var N=r(184);const f=e=>{let{id:t}=e;const r=(0,m.TL)(),s=(0,l.v9)((e=>(0,u.Vt)(e,t))),{name:n,image:a,price:c}=s,i=(0,l.v9)((e=>g(e,t))),[{beingDragged:p},x]=(0,o.c)({type:"ingredient",item:s,collect:e=>({beingDragged:e.isDragging()})});return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)("li",{ref:x,className:"".concat(h," ").concat(p?"".concat(b):""),onClick:()=>(e=>r((0,j.Up)(e)))(t),children:[(0,N.jsx)("img",{className:"mr-4 ml-4",src:a,alt:n}),(0,N.jsxs)("div",{className:"pt-2",children:[(0,N.jsxs)("p",{className:"".concat(y," text text_type_digits-default"),children:[(0,N.jsx)("span",{className:"mr-2",children:c}),(0,N.jsx)(d.rm,{type:"primary"})]}),(0,N.jsx)("p",{className:"".concat(v," text text_type_main-default mt-2"),children:n})]}),i>0&&(0,N.jsx)(d.AT,{count:i,size:"default"})]})})},C="IngredientList_root__1m0nr",k=e=>{let{ingredientIds:t}=e;return(0,N.jsx)("ul",{className:"".concat(C," pr-4 pb-10 pl-4"),children:t.map((e=>(0,N.jsx)(f,{id:e},e)))})},B=(0,c.forwardRef)(((e,t)=>{let{type:r,label:s}=e;const n=(0,l.v9)(u.pT),a=(0,l.v9)((e=>(0,u.e2)(e,r)));return n?(0,N.jsx)(i.a,{}):(0,N.jsxs)("li",{children:[(0,N.jsx)("h2",{ref:t,className:"text text_type_main-medium mb-6",children:s}),(0,N.jsx)(k,{ingredientIds:a})]})}));var I=r(4164);const M="Modal_root__z7+I3",E="Modal_isOpen__zYv3o",T="Modal_container__Ha+Ky",L="Modal_closeButton__Ya+Ev",O=e=>{let{isOpen:t,onClose:r,onBackdropClick:s,children:n}=e;return(0,I.createPortal)((0,N.jsx)("div",{className:"".concat(M," ").concat(t?"".concat(E):""),onClick:s,children:(0,N.jsxs)("div",{className:"".concat(T," pt-25 pr-10 pb-25 pl-10"),children:[n,(0,N.jsx)("button",{className:L,type:"button","aria-label":"Close modal",onClick:r,children:(0,N.jsx)(d.Tw,{type:"primary"})})]})}),document.querySelector(".portal"))},w="NutritionFacts_root__RjsFs",F="NutritionFacts_image__p-fix",S="NutritionFacts_list__on7pF",R="NutritionFacts_listItem__ffIlj",P=e=>{let{ingredientId:t}=e;const r=(0,l.v9)((e=>(0,u.Vt)(e,t))),{name:s,calories:n,carbohydrates:a,fat:c,proteins:i,image_large:o}=r,d="mb-2 text text_type_main-default text_color_inactive",m="mb-2 text text_type_digits-default text_color_inactive";return(0,N.jsxs)("div",{className:w,children:[(0,N.jsx)("h2",{className:"text text_type_main-large",children:"Nutrition Facts"}),(0,N.jsx)("img",{className:"".concat(F," mt-4"),src:o,alt:s}),(0,N.jsx)("p",{className:"mt-4 text text_type_main-medium",children:s}),(0,N.jsxs)("dl",{className:S,children:[(0,N.jsxs)("div",{className:R,children:[(0,N.jsx)("dt",{className:d,children:"Calories"}),(0,N.jsx)("dd",{className:m,children:n})]}),(0,N.jsxs)("div",{className:R,children:[(0,N.jsx)("dt",{className:d,children:"Total Carb."}),(0,N.jsx)("dd",{className:m,children:a})]}),(0,N.jsxs)("div",{className:R,children:[(0,N.jsx)("dt",{className:d,children:"Total Fat"}),(0,N.jsx)("dd",{className:m,children:c})]}),(0,N.jsxs)("div",{className:R,children:[(0,N.jsx)("dt",{className:d,children:"Protein"}),(0,N.jsx)("dd",{className:m,children:i})]})]})]})},D=()=>{const{isModalOpen:e,previewedIngredientId:t,closeModal:r,closeByBackdropClick:s}=(()=>{const e=(0,m.TL)(),[t,r]=(0,c.useState)(!1),s=(0,l.v9)(u.Ec),n=(0,c.useCallback)((()=>{r(!0)}),[]),a=(0,c.useCallback)((()=>{e((0,j.ni)()),r(!1)}),[e]),i=(0,c.useCallback)((e=>{e instanceof KeyboardEvent&&"Escape"===e.code&&a()}),[a]);return(0,c.useEffect)((()=>{s&&n()}),[s,n]),(0,c.useEffect)((()=>(t&&document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i))),[i,t]),{isModalOpen:t,previewedIngredientId:s,openModal:n,closeModal:a,closeByBackdropClick:e=>{e.target===e.currentTarget&&a()}}})();return t?(0,N.jsx)(O,{isOpen:e,onClose:r,onBackdropClick:s,children:(0,N.jsx)(P,{ingredientId:t})}):null},H=[{type:"bun",label:"Buns"},{type:"burger",label:"Burgers"},{type:"topping",label:"Toppings"}];const K=function(){const[e,t]=(0,c.useState)(H[0].type),r=(0,c.useRef)(null),s={};return H.forEach((e=>s[e.type]=(0,c.createRef)())),{currentTab:e,handleTabClick:e=>{const t=H.find((t=>t.type===e));if(t){const{type:e}=t;(r=s[e]).current&&r.current.scrollIntoView({behavior:"smooth"})}var r},handleIngredientsScroll:()=>{var e;const n=null===(e=r.current)||void 0===e?void 0:e.getBoundingClientRect().y,a=H.map((e=>Math.abs(s[e.type].current.getBoundingClientRect().y-n))),c=a.indexOf(Math.min(...a));t(H[c].type)},ingredientsRef:r,ingredientGroupRefs:s}},Y="BurgerIngredients_tabBar__jn4fI",z="BurgerIngredients_menu__X3WWl",V=()=>{const{currentTab:e,handleTabClick:t,handleIngredientsScroll:r,ingredientsRef:s,ingredientGroupRefs:n}=K();return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("section",{className:"mt-10",children:[(0,N.jsx)("h1",{className:"text text_type_main-large",children:"Build Your Own Burger"}),(0,N.jsx)("ul",{className:"".concat(Y," mt-5"),children:H.map((r=>(0,N.jsx)("li",{children:(0,N.jsx)(a.Tab,{active:e===r.type,value:r.type,onClick:t,children:r.label})},r.type)))}),(0,N.jsx)("ul",{className:"".concat(z," custom-scroll"),ref:s,onScroll:r,children:H.map((e=>(0,N.jsx)(B,{type:e.type,label:e.label,ref:n[e.type]},e.type)))})]}),(0,N.jsx)(D,{})]})};var W=r(8422);const G="BunElement_root__P2lJ4",q=e=>{let{type:t}=e;const r=(0,l.v9)(_);return(0,N.jsx)("div",{className:"".concat(G," ml-8 pr-4"),children:(0,N.jsx)(d.DY,{type:t,text:r?"".concat(r.name," ").concat("top"===t?"(top)":"(bottom)"):"Choose your bun",price:r?r.price:0,thumbnail:r?r.image:"https://stellarburgers.nomoreparties.site/static/media/loading.89540200.svg",isLocked:!0})})};var J=r(2942),Q=r(3052);const U="FillingListItem_root__Kz4P+",X="FillingListItem_isHovered__6iFKh",A=e=>{let{index:t,ingredient:r}=e;const s=(0,m.TL)(),{name:n,price:a,image:l}=r,[,i]=(0,o.c)({type:"addedIngredient",item:()=>({index:t})}),[{isHovered:u},p]=(0,W.L)({accept:"addedIngredient",collect:e=>({isHovered:e.isOver()}),drop:e=>{e.index!==t&&s((0,Q.CI)({fromIndex:e.index,toIndex:t}))}}),x=(0,c.useRef)(null);return i(p(x)),(0,N.jsxs)("li",{ref:x,className:"".concat(U," ").concat(u?"".concat(X):""," mt-4 mb-4"),children:[(0,N.jsx)(J.DragIcon,{type:"primary"}),(0,N.jsx)(d.DY,{text:n,thumbnail:l,price:a,handleClose:()=>s((0,Q.HF)(t))})]})},Z="FillingList_root__CWjeS",$=()=>{const e=(0,l.v9)(x);return(0,N.jsx)("ul",{className:"".concat(Z," custom-scroll"),children:e.map(((e,t)=>(0,N.jsx)(A,{index:t,ingredient:e},e._id)))})};var ee=r(4865);const te=r.p+"static/media/success.ffd5c56d9db3cece5522.png",re="OrderConfirmation_root__Y5Pjh",se="OrderConfirmation_orderNumber__F7HYV",ne=e=>{let{orderNumber:t}=e;return(0,N.jsxs)("div",{className:re,children:[(0,N.jsx)("span",{className:"mb-8 text text_type_main-medium",children:"Your order number is"}),(0,N.jsx)("h2",{className:"".concat(se," text text_type_digits-large"),children:t}),(0,N.jsx)("img",{className:"mt-15 mb-15",src:te,alt:"Success icon"}),(0,N.jsx)("p",{className:"mb-2 text text_type_main-default",children:"your order is being prepared"}),(0,N.jsx)("p",{className:"text text_type_main-default text_color_inactive",children:"be ready to pick it up at the orbital station"})]})},ae=e=>e.order,ce=e=>e.order.number;var le=r(1042);const ie=()=>{const{isModalOpen:e,closeModal:t,closeByBackdropClick:r,orderNumber:s}=(()=>{const e=(0,m.TL)(),[t,r]=(0,c.useState)(!1),s=(0,l.v9)(ce),n=(0,c.useCallback)((()=>{r(!0)}),[]),a=(0,c.useCallback)((()=>{e((0,le.qm)()),e((0,Q.VS)()),r(!1)}),[e]),i=(0,c.useCallback)((e=>{e instanceof KeyboardEvent&&"Escape"===e.code&&a()}),[a]);return(0,c.useEffect)((()=>{s&&n()}),[s,n]),(0,c.useEffect)((()=>(t&&document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i))),[i,t]),{isModalOpen:t,orderNumber:s,openModal:n,closeModal:a,closeByBackdropClick:e=>{e.target===e.currentTarget&&a()}}})();return s?(0,N.jsx)(O,{isOpen:e,onClose:t,onBackdropClick:r,children:(0,N.jsx)(ne,{orderNumber:s})}):null};var oe=r(2263);const de=()=>{const e=(0,m.TL)(),[t,r]=(0,c.useState)(!1),s=(0,c.useCallback)((()=>{r(!0)}),[]),n=(0,c.useCallback)((()=>{e((0,le.fw)()),r(!1)}),[e]),a=(0,c.useCallback)((e=>{e instanceof KeyboardEvent&&"Escape"===e.code&&n()}),[n]);return(0,c.useEffect)((()=>(t&&document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a))),[a,t]),{isModalOpen:t,openModal:s,closeModal:n,closeByBackdropClick:e=>{e.target===e.currentTarget&&n()}}},me="ErrorModal_content__fCl0B",ue="ErrorModal_errorSign__vWha6",pe=e=>{let{isOpen:t,errorText:r}=e;const{closeModal:s,closeByBackdropClick:n}=de();return(0,N.jsx)(O,{isOpen:t,onClose:s,onBackdropClick:n,children:(0,N.jsxs)("div",{className:me,children:[(0,N.jsx)("div",{className:ue,children:(0,N.jsx)(d.Tw,{type:"primary"})}),(0,N.jsx)(oe.B,{children:r})]})})};var xe=r(609);const _e="SubmitGroup_root__OQ4Lo",ge="SubmitGroup_button__68UXa",je=()=>{const e=(0,m.TL)(),{isFetching:t,error:r}=(0,l.v9)(ae),s=(0,l.v9)(_),n=(0,l.v9)(x),{isModalOpen:a,openModal:o}=de(),u=(0,c.useMemo)((()=>s?2*s.price:0),[s])+(0,c.useMemo)((()=>n.reduce(((e,t)=>e+t.price),0)),[n]);return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)("div",{className:"".concat(_e," mt-10 pr-4 pl-4"),children:[(0,N.jsxs)("span",{className:"text text_type_digits-medium mr-10",children:[u," ",(0,N.jsx)(d.rm,{type:"primary"})]}),(0,N.jsxs)("div",{className:ge,children:[(0,N.jsx)(ee.z,{type:"button",view:"primary",size:"large",onClick:()=>{if(s&&n.length){const t=[s,...n,s].map((e=>e._id));e((0,xe.D)({ingredients:t})).then((()=>o()))}},disabled:!s||!n.length,children:"Place an order"}),t&&(0,N.jsx)(i.a,{})]}),(0,N.jsx)(ie,{}),r&&(0,N.jsx)(pe,{isOpen:a,errorText:r})]})})},he="BurgerConstructor_root__fVIgZ",be="BurgerConstructor_isHovered__i8Ijv",ve=()=>{const e=(0,m.TL)(),[{isHovered:t},r]=(0,W.L)({accept:"ingredient",collect:e=>({isHovered:e.isOver()}),drop:e=>{s(e)}}),s=t=>{"bun"===t.type?e((0,Q.Xq)(t)):e((0,Q.Ee)(t))};return(0,N.jsxs)("section",{className:"".concat(he," pt-25 pb-10"),children:[(0,N.jsxs)("div",{ref:r,className:t?"".concat(be):"",children:[(0,N.jsx)(q,{type:"top"}),(0,N.jsx)($,{}),(0,N.jsx)(q,{type:"bottom"})]}),(0,N.jsx)(je,{})]})},ye="BurgerBuilder_root__M-A1J",Ne=()=>(0,N.jsx)("div",{className:ye,children:(0,N.jsxs)(s.W,{backend:n.PD,children:[(0,N.jsx)(V,{}),(0,N.jsx)(ve,{})]})})}}]);
//# sourceMappingURL=473.28404ce2.chunk.js.map